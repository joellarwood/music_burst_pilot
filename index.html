<!doctype html>
<html>
  <head>
    <title>Music Selector</title>
    <script src="jspsych-6.1.0/jspsych.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-audio-keyboard-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-instructions.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-likert.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-slider-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-audio-button-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-multi-choice.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-external-html.js"></script>
    <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>

  </head>

  <body></body>
  <script>

  /* create timeline */
  var timeline = [];

  /* assign subject ID */
  var subject_id = jsPsych.randomization.randomID(15);
  jsPsych.data.addProperties(
    {
      subject: subject_id
    }
);


  /* get consent */
  var check_consent = function(elem) {
  if (document.getElementById('consent_checkbox').checked) {
    return true;
  }
  else {
    alert("If you wish to participate, you must check the box next to the statement 'I agree to participate in this study.'");
    return false;
  }
  return false;
};


// Consent block.
var consent = {
  type:'external-html',
  url: 'static/consent.html',
  cont_btn: "start",
  check_fn: check_consent
};

timeline.push(consent)

// declare instructions

var instructions = {
  type: 'instructions',
  pages: [
    "Welcome to the Experiment. Please Click next to begin",
    "<p>In this study you will listen to a number of short musical clips. </p>",
    "<p>Each song is presented in a trial<p>",
    "<p> In each trial you will first listen to a musical clip</p>" +
    "<p> After listening to the clip you will rate what emotion the musical clip expressed <p>" +
    "<p>Finally you will rate how pleasant the feeling expressed by the song is and also how energetic/activating it was</p>",
    "On the next page a song will play automatically. </p><p>Please adjust the volume so that the song is at a comfortable volume <br>",
    "Adjust the volume on your computer so that it is at a comfortable level. </p>" +
    "<p><audio autoplay src='audio/test_audio_short.mp3'></audio></p>" +
    "Press next when the audio is at a comfortable level",
    "<p> The experiment will begin when you press next. </p><p>Remember that you are rating emotion or feeling you think the song is trying to express"
  ],
  show_clickable_nav: true
}

timeline.push(instructions)

/* define audio */
var audio = [
  "audio/1_Be_Happy.mp3",
  "audio/1_Skinny_Love.mp3",
  "audio/1_The_Sweetest.mp3",
  "audio/2_Blood_On_The_Ground.mp3",
  "audio/2_Boser_Wolf.mp3",
  "audio/2_Incomplete.mp3",
  "audio/2_Inside.mp3",
  "audio/2_Love's_Requiem.mp3",
  "audio/2_On_A_Slow_Boat_To_China.mp3",
  "audio/2_Sweet_Song.mp3",
  "audio/3_It_Only_Hurts_When_I'm_Breathing.mp3",
  "audio/3_Old_Blacktop.mp3",
  "audio/3_Walk_on_the_wild_side.mp3",
  "audio/4_Come_On_Baby.mp3",
  "audio/4_Destiny.mp3",
  "audio/4_Make_Light.mp3",
  "audio/4_Mbube.mp3",
  "audio/5_Get_Lucky.mp3",
  "audio/5_Love's_Requiem.mp3",
  "audio/5_Valerie.mp3",
  "audio/7_Digital.mp3",
  "audio/7_Here_Today.mp3",
  "audio/8_Fire_And_Rain__(LP_Version).mp3",
  "audio/8_Restless.mp3",
  "audio/9_If_The_Creeks_Don't_Rise.mp3",
  "audio/9_Pain_(Live_Version).mp3",
  "audio/11_Be_Happy.mp3",
  "audio/12_Fire_And_Rain_(LP_Version).mp3",
  "audio/12_Skank_Down.mp3",
  "audio/12_Skinny_Love.mp3",
  "audio/12_Skinny_Love.mp3",
  "audio/13_Boser_Wolf.mp3",
  "audio/13_If_The_Creeks_Don't_Rise.mp3",
  "audio/13_Motown_Junk.mp3",
  "audio/14_Get_Lucky.mp3",
  "audio/28_Valerie.mp3",
  "audio/15_Bunkertor_7_(German_Texture).mp3",
  "audio/15_Here_Today.mp3",
  "audio/16_Restless.mp3",
  "audio/19_I_hate_Everything_About_You.mp3",
  "audio/21_Skank_Down.mp3",
  "audio/23_Inside.mp3",
  "audio/24_Restless.mp3",
  "audio/25_Old_Blacktop.mp3",
  "audio/26_Make_Light.mp3",
  "audio/26_It_Only_Hurts_When_I'm_Breathing.mp3"
]

var test_stimuli = [{
    stimulus: "audio/1_Be_Happy.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/1_Skinny_Love.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/1_The_Sweetest.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/2_Blood_On_The_Ground.mp3",
    data: {
      test_part: "song",
      target: "angry"
    }
  },
  {
    stimulus: "audio/2_Boser_Wolf.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/2_Incomplete.mp3",
    data: {
      test_part: "song",
      target: "angry"
    }
  },
  {
    stimulus: "audio/2_Inside.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/2_Love's_Requiem.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/2_On_A_Slow_Boat_To_China.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/2_Sweet_Song.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/3_It_Only_Hurts_When_I'm_Breathing.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/3_Old_Blacktop_[Album_Version].mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/3_Walk_on_the_wild_side.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/4_Come_On_Baby.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/4_Destiny.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/4_Make_Light.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/4_Mbube.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/5_Get_Lucky.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/5_Love's_Requiem.mp3",
    data: {
    test_part: "song",
    target: "sad"
  }
  },
  {
    stimulus: "audio/5_Valerie.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/7_Digital.mp3",
    data: {
      test_part: "song",
      target: "relaxed"
    }
  },
  {
    stimulus: "audio/7_Here_Today.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/8_Fire_And_Rain__(LP_Version).mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/8_Restless.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/9_If_The_Creeks_Don't_Rise.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/9_Pain_(Live_Version).mp3",
    data: {
      test_part: "song",
      target: "angry"
    }
  },
  {
    stimulus: "audio/11_Be_Happy.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/12_Fire_And_Rain_(LP_Version).mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/12_Skank_Down.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/12_Skinny_Love.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/13_Boser_Wolf.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/13_If_The_Creeks_Don't_Rise.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/13_Motown_Junk.mp3",
    data: {
      test_part: "song",
      target: "angry"
    }
  },
  {
    stimulus: "audio/14_Get_Lucky.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/28_Valerie.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/15_Bunkertor_7_(German_Texture).mp3",
    data: {
      test_part: "song",
      target: "angry"
  }
  },
  {
    stimulus: "audio/15_Here_Today.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/16_Restless.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/19_I_hate_Everything_About_You.mp3",
    data: {
      test_part: "song",
      target: "angry"
    }
  },
  {
    stimulus: "audio/21_Skank_Down.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/23_Inside.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/24_Restless.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/25_Old_Blacktop_[Album_Version].mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  },
  {
    stimulus: "audio/26_Make_Light.mp3",
    data: {
      test_part: "song",
      target: "happy"
    }
  },
  {
    stimulus: "audio/26_It_Only_Hurts_When_I'm_Breathing.mp3",
    data: {
      test_part: "song",
      target: "sad"
    }
  }
];

/* Experimental trials */

var fixation_black = {
  type: 'html-keyboard-response',
  stimulus: '<div style="font-size:60px;">+</div>',
  choices: jsPsych.NO_KEYS,
  trial_duration: 1000,
  data: {test_part: "fixation"}
}

var fixation_green = {
  type: 'html-keyboard-response',
  stimulus: '<div style="font-size:60px;color:green">+</div>',
  choices: jsPsych.NO_KEYS,
  trial_duration: 500,
  data: {test_part: "fixation"}
}

var songs = {
  type: "audio-keyboard-response",
  stimulus: jsPsych.timelineVariable('stimulus'),
  trial_duration: 1000,
  data: jsPsych.timelineVariable('data')
}

var emotion = {
  type: 'survey-multi-choice',
  questions: [{
    prompt: "What emotion did this musical clip express?",
    options: [
      "Happy",
      "Sad",
      "Angry",
      "Relaxed",
      "None of these"
    ]
  }],
  data: {test_part: "emotion_rating"}
}

var valence = {
  type: 'html-slider-response',
  stimulus: '<p>How negative/positive was this feeling expressed in this musical clip</p>',
  labels: ['Very Negative', 'Very Positive'],
  data: {test_part: "valence rating"}
}

var arousal = {
  type: 'html-slider-response',
  stimulus: "<p>How energetic/arousing was the feeling expressed in this musical clip</p>",
  labels: ['Very Low', 'Very High'],
  data: {test_part: "arousal rating"}
}

var test_procedure = {
  timeline: [fixation_black, fixation_green, songs, emotion, valence, arousal],
  timeline_variables: test_stimuli,
  randomize_order: true
}
timeline.push(test_procedure);

var 

jsPsych.init({
  timeline: timeline,
  preload_audio: ['audio/test_audio_short.mp3',
                  audio]
});

  </script>
</html>
